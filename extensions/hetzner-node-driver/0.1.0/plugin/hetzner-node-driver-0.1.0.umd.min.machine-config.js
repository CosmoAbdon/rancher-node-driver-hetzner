(("undefined"!==typeof self?self:this)["webpackChunkhetzner_node_driver_0_1_0"]=("undefined"!==typeof self?self:this)["webpackChunkhetzner_node_driver_0_1_0"]||[]).push([[921],{313:function(e,r,a){"use strict";a.r(r),a.d(r,{default:function(){return Z}});var l=a(9274),t=a(7619),i=a(5524),n=a(3999),s=a(6710),o=a(5576),d=a(8745);function c(e,r,a){return(r=u(r))in e?Object.defineProperty(e,r,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[r]=a,e}function u(e){var r=v(e,"string");return"symbol"==typeof r?r:r+""}function v(e,r){if("object"!=typeof e||!e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var l=a.call(e,r||"default");if("object"!=typeof l)return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(e)}class p{constructor(e){c(this,"credentialId",void 0),c(this,"BASE_URL","/meta/proxy/api.hetzner.cloud/v1"),this.credentialId=e}async getLocations(){const e=await this.request("/locations");return e.locations.map(e=>({value:e.name,label:`${e.name} (${e.description})`}))}async getServerTypes(e){const r=await this.request("/server_types?per_page=50");let a=r.server_types.filter(e=>!e.deprecated);return e&&(a=a.filter(r=>r.prices.some(r=>r.location===e))),a.map(r=>{let a="";if(e){const l=r.prices.find(r=>r.location===e);l&&(a=`â‚¬${Number(l.price_monthly.gross).toFixed(2)}/mo, `)}return{value:r.name,label:`${r.name} (${a}${r.architecture}, ${r.cores} vCPU, ${r.memory} GB RAM, ${r.disk} GB SSD)`}})}async getImages(){const e=await this.request("/images?per_page=50");return e.images.map(e=>({value:e.id,label:`${e.name} (${e.architecture}) - ${e.description}`}))}async getPlacementGroups(){const e=await this.request("/placement_groups?per_page=50");return e.placement_groups.map(e=>({value:e.id,label:e.name}))}async getNetworks(){const e=await this.request("/networks?per_page=50");return e.networks.map(e=>({value:e.id,label:`${e.name} (${e.ip_range})`}))}async getFirewalls(){const e=await this.request("/firewalls?per_page=50");return e.firewalls.map(e=>({value:e.id,label:e.name}))}async request(e,r="GET",a){const l=`${this.BASE_URL}${e}`,t={"X-Api-CattleAuth-Header":`Bearer credID=${this.credentialId} passwordField=apiToken`};a&&(t["Content-Type"]="application/json");const i=await fetch(l,{method:r,headers:t,body:a?JSON.stringify(a):void 0});if(!i.ok)throw new Error(`HTTP error! status: ${i.status}`);return i.json()}}function m(e){return null!=e?String(e):void 0}function b(e){if(null!=e)return"string"===typeof e?Number(e):e}function f(e){return Array.isArray(e)?e.map(e=>"string"===typeof e?Number(e):e):[]}function h(e,r){const a=(0,l.reactive)({disablePublicNetwork:!1,disablePublicIpv4:!1,disablePublicIpv6:!1,usePrivateNetwork:!1,firewallIds:[],networkIds:[],placementGroupId:void 0,serverImage:void 0,serverType:void 0,serverLocation:void 0,additionalUserData:void 0,serverLabels:{}}),t=(0,l.ref)(!1),i=(0,l.ref)(!1),n=(0,l.ref)(!1),s=(0,l.ref)([]);function o(){const e=[];a.serverLocation||e.push({field:"serverLocation",message:"Location is required"}),a.serverType||e.push({field:"serverType",message:"Server type is required"}),a.serverImage||e.push({field:"serverImage",message:"Image is required"});const r=a.disablePublicNetwork||a.disablePublicIpv4||a.disablePublicIpv6;return r&&!a.usePrivateNetwork&&e.push({field:"network",message:"Private network must be enabled when disabling public network access"}),a.usePrivateNetwork&&!a.networkIds?.length&&e.push({field:"networkIds",message:"At least one network must be selected when using private network"}),e}function d(e){return s.value.find(r=>r.field===e)?.message}function c(e){return s.value.some(r=>r.field===e)}async function u(){if(!n.value)return;t.value=!0;const r=e.value;r.serverType=m(a.serverType),r.serverLocation=m(a.serverLocation),r.imageId=m(a.serverImage),r.placementGroup=m(a.placementGroupId),r.networks=a.networkIds?.map(e=>e?.toString())||[],r.firewalls=a.firewallIds?.map(e=>e?.toString())||[],r.usePrivateNetwork=a.usePrivateNetwork,a.disablePublicNetwork?(r.disablePublic=!0,r.disablePublicIpv4=!1,r.disablePublicIpv6=!1):(r.disablePublic=!1,r.disablePublicIpv4=a.disablePublicIpv4,r.disablePublicIpv6=a.disablePublicIpv6),r.additionalUserData=a.additionalUserData,r.userDataFromFile=!0,r.serverLabel=a.serverLabels?Object.entries(a.serverLabels).map(([e,r])=>`${e}=${r}`):[],await(0,l.nextTick)(),t.value=!1}function v(e){i.value=!0,a.serverType=m(e.serverType),a.serverLocation=m(e.serverLocation),a.serverImage=b(e.imageId),a.placementGroupId=b(e.placementGroup),a.networkIds=f(e.networks),a.firewallIds=f(e.firewalls),a.usePrivateNetwork=e.usePrivateNetwork,a.disablePublicNetwork=e.disablePublic,a.disablePublicIpv4=e.disablePublicIpv4,a.disablePublicIpv6=e.disablePublicIpv6,a.additionalUserData=e.additionalUserData||"",a.serverLabels=Object.fromEntries((e.serverLabel||[]).map(e=>e.split("="))),i.value=!1}return(0,l.watch)(e,async e=>{t.value||(v(e),await(0,l.nextTick)())},{immediate:!0,deep:!0}),(0,l.watch)(a,async()=>{s.value=o();const e=0===s.value.length;n.value=e,r("validationChanged",e),e&&!i.value&&await u()},{immediate:!0,deep:!0}),{serverConfiguration:a,isValid:n,validationErrors:s,syncingFromProps:i,syncingToProps:t,getErrorForField:d,hasError:c}}var g=a(3927),w=a(4364);const y={class:"hetzner-config"},k={class:"mt-20 mb-20"},N={class:"row mt-10"},I={class:"col span-12"},P={key:0,class:"field-error"},E={class:"row mt-10"},z={class:"col span-6"},V={key:0,class:"field-error"},T={class:"col span-6"},_={key:0,class:"field-error"},C={class:"row mt-10"},L={class:"col span-12"},A={class:"mt-30 mb-20"},D={class:"row mt-10 vcenter"},U={class:"col span-6"},S={class:"col span-6"},B={class:"row mt-20"},$={class:"col span-4"},G={class:"col span-4"},j={class:"col span-4"},F={class:"row mt-20"},q={class:"col span-12"},x={class:"mt-30 mb-20"},O={class:"row mt-10"},M={class:"col span-12"},R={class:"mb-5"},H={class:"description mb-10"},J={class:"row mt-10"},X={class:"col span-12"},K=(0,l.defineComponent)({mixins:[g.A]});var Q=(0,l.defineComponent)({...K,__name:"hetzner",props:{uuid:{},cluster:{default:()=>({})},value:{},credentialId:{},provider:{},disabled:{type:Boolean,default:!1},busy:{type:Boolean,default:!1}},emits:["validationChanged"],setup(e,{emit:r}){const a=e,c=r,u=(0,l.ref)({locations:[],serverTypes:[],serverImages:[],firewalls:[],networks:[],placementGroups:[]}),v=(0,l.toRef)(a,"value"),{serverConfiguration:m,validationErrors:b,getErrorForField:f,hasError:g}=h(v,c),K=(0,l.ref)(!0),Q=(0,l.ref)(!0),W=(0,l.ref)(null),Y=(0,l.computed)(()=>K.value||a.busy),Z=(0,l.computed)(()=>{const e=f("network"),r=f("networkIds");return e||r});return(0,l.watch)(()=>m.serverLocation,async e=>{if(W.value){K.value=!0;try{u.value.serverTypes=await W.value.getServerTypes(e),u.value.serverTypes.some(e=>e.value===m.serverType)||(m.serverType=void 0)}catch(r){w.error("Failed to load server types:",r)}finally{K.value=!1}}}),(0,l.onMounted)(async()=>{W.value=new p(a.credentialId);try{const[e,r,a,l,t,i]=await Promise.all([W.value.getLocations(),W.value.getServerTypes(),W.value.getImages(),W.value.getPlacementGroups(),W.value.getNetworks(),W.value.getFirewalls()]);u.value.locations=e,u.value.serverTypes=r,u.value.serverImages=a,u.value.placementGroups=l,u.value.networks=t,u.value.firewalls=i}catch(e){w.error("Failed to load Hetzner data:",e)}K.value=!1,Q.value=!1}),(e,r)=>((0,l.openBlock)(),(0,l.createElementBlock)("div",null,[Q.value?((0,l.openBlock)(),(0,l.createBlock)(t.A,{key:0,delayed:!0})):(0,l.createCommentVNode)("",!0),(0,l.createElementVNode)("div",y,[(0,l.createElementVNode)("h2",k,(0,l.toDisplayString)(e.t("driver.hetzner.machine.server.title")),1),(0,l.createElementVNode)("div",N,[(0,l.createElementVNode)("div",I,[(0,l.createVNode)(i.A,{value:(0,l.unref)(m).serverLocation,"onUpdate:value":r[0]||(r[0]=e=>(0,l.unref)(m).serverLocation=e),options:u.value.locations,required:"",disabled:Y.value,loading:Y.value,placeholder:e.t("driver.hetzner.machine.server.location.placeholder"),label:e.t("driver.hetzner.machine.server.location.label"),class:(0,l.normalizeClass)({"has-error":(0,l.unref)(g)("serverLocation")})},null,8,["value","options","disabled","loading","placeholder","label","class"]),(0,l.unref)(g)("serverLocation")?((0,l.openBlock)(),(0,l.createElementBlock)("span",P,(0,l.toDisplayString)((0,l.unref)(f)("serverLocation")),1)):(0,l.createCommentVNode)("",!0)])]),(0,l.createElementVNode)("div",E,[(0,l.createElementVNode)("div",z,[(0,l.createVNode)(i.A,{value:(0,l.unref)(m).serverType,"onUpdate:value":r[1]||(r[1]=e=>(0,l.unref)(m).serverType=e),options:u.value.serverTypes,required:"",disabled:Y.value,loading:Y.value,placeholder:e.t("driver.hetzner.machine.server.type.placeholder"),label:e.t("driver.hetzner.machine.server.type.label"),class:(0,l.normalizeClass)({"has-error":(0,l.unref)(g)("serverType")})},null,8,["value","options","disabled","loading","placeholder","label","class"]),(0,l.unref)(g)("serverType")?((0,l.openBlock)(),(0,l.createElementBlock)("span",V,(0,l.toDisplayString)((0,l.unref)(f)("serverType")),1)):(0,l.createCommentVNode)("",!0)]),(0,l.createElementVNode)("div",T,[(0,l.createVNode)(i.A,{value:(0,l.unref)(m).serverImage,"onUpdate:value":r[2]||(r[2]=e=>(0,l.unref)(m).serverImage=e),options:u.value.serverImages,required:"",disabled:Y.value,loading:Y.value,placeholder:e.t("driver.hetzner.machine.server.image.placeholder"),label:e.t("driver.hetzner.machine.server.image.label"),class:(0,l.normalizeClass)({"has-error":(0,l.unref)(g)("serverImage")})},null,8,["value","options","disabled","loading","placeholder","label","class"]),(0,l.unref)(g)("serverImage")?((0,l.openBlock)(),(0,l.createElementBlock)("span",_,(0,l.toDisplayString)((0,l.unref)(f)("serverImage")),1)):(0,l.createCommentVNode)("",!0)])]),(0,l.createElementVNode)("div",C,[(0,l.createElementVNode)("div",L,[(0,l.createVNode)(i.A,{value:(0,l.unref)(m).placementGroupId,"onUpdate:value":r[3]||(r[3]=e=>(0,l.unref)(m).placementGroupId=e),options:u.value.placementGroups,clearable:"",disabled:Y.value,loading:Y.value,placeholder:e.t("driver.hetzner.machine.server.placementGroup.placeholder"),label:e.t("driver.hetzner.machine.server.placementGroup.label")},null,8,["value","options","disabled","loading","placeholder","label"])])]),(0,l.createElementVNode)("h2",A,(0,l.toDisplayString)(e.t("driver.hetzner.machine.network.title")),1),Z.value?((0,l.openBlock)(),(0,l.createBlock)(d.A,{key:0,color:"warning",label:Z.value},null,8,["label"])):(0,l.createCommentVNode)("",!0),(0,l.createElementVNode)("div",D,[(0,l.createElementVNode)("div",U,[(0,l.createVNode)(i.A,{value:(0,l.unref)(m).networkIds,"onUpdate:value":r[4]||(r[4]=e=>(0,l.unref)(m).networkIds=e),options:u.value.networks,multiple:"",disabled:Y.value,loading:Y.value,placeholder:e.t("driver.hetzner.machine.network.networks.placeholder"),label:e.t("driver.hetzner.machine.network.networks.label"),class:(0,l.normalizeClass)({"has-error":(0,l.unref)(g)("networkIds")})},null,8,["value","options","disabled","loading","placeholder","label","class"])]),(0,l.createElementVNode)("div",S,[(0,l.createVNode)(s.A,{value:(0,l.unref)(m).usePrivateNetwork,"onUpdate:value":r[5]||(r[5]=e=>(0,l.unref)(m).usePrivateNetwork=e),disabled:Y.value,label:e.t("driver.hetzner.machine.network.private.label"),description:e.t("driver.hetzner.machine.network.private.description")},null,8,["value","disabled","label","description"])])]),(0,l.createElementVNode)("div",B,[(0,l.createElementVNode)("div",$,[(0,l.createVNode)(s.A,{value:(0,l.unref)(m).disablePublicNetwork,"onUpdate:value":r[6]||(r[6]=e=>(0,l.unref)(m).disablePublicNetwork=e),disabled:Y.value||!(0,l.unref)(m).networkIds?.length,label:e.t("driver.hetzner.machine.network.disablePublic.label"),description:e.t("driver.hetzner.machine.network.disablePublic.description")},null,8,["value","disabled","label","description"])]),(0,l.createElementVNode)("div",G,[(0,l.createVNode)(s.A,{value:(0,l.unref)(m).disablePublicIpv4,"onUpdate:value":r[7]||(r[7]=e=>(0,l.unref)(m).disablePublicIpv4=e),disabled:Y.value||(0,l.unref)(m).disablePublicNetwork,label:e.t("driver.hetzner.machine.network.disableIPv4.label"),description:e.t("driver.hetzner.machine.network.disableIPv4.description")},null,8,["value","disabled","label","description"])]),(0,l.createElementVNode)("div",j,[(0,l.createVNode)(s.A,{value:(0,l.unref)(m).disablePublicIpv6,"onUpdate:value":r[8]||(r[8]=e=>(0,l.unref)(m).disablePublicIpv6=e),disabled:Y.value||(0,l.unref)(m).disablePublicNetwork,label:e.t("driver.hetzner.machine.network.disableIPv6.label"),description:e.t("driver.hetzner.machine.network.disableIPv6.description")},null,8,["value","disabled","label","description"])])]),(0,l.createElementVNode)("div",F,[(0,l.createElementVNode)("div",q,[(0,l.createVNode)(i.A,{value:(0,l.unref)(m).firewallIds,"onUpdate:value":r[9]||(r[9]=e=>(0,l.unref)(m).firewallIds=e),options:u.value.firewalls,multiple:"",disabled:Y.value,loading:Y.value,placeholder:e.t("driver.hetzner.machine.network.firewalls.placeholder"),label:e.t("driver.hetzner.machine.network.firewalls.label")},null,8,["value","options","disabled","loading","placeholder","label"])])]),(0,l.createElementVNode)("h2",x,(0,l.toDisplayString)(e.t("driver.hetzner.machine.additionalConfig.title")),1),(0,l.createElementVNode)("div",O,[(0,l.createElementVNode)("div",M,[(0,l.createElementVNode)("h3",R,(0,l.toDisplayString)(e.t("driver.hetzner.machine.additionalConfig.userData.label")),1),(0,l.createElementVNode)("div",H,(0,l.toDisplayString)(e.t("driver.hetzner.machine.additionalConfig.userData.description")),1),(0,l.createVNode)(o.A,{value:(0,l.unref)(m).additionalUserData,"onUpdate:value":r[10]||(r[10]=e=>(0,l.unref)(m).additionalUserData=e),disabled:Y.value,placeholder:e.t("driver.hetzner.machine.additionalConfig.userData.placeholder"),label:e.t("driver.hetzner.machine.additionalConfig.userData.label"),showCodeEditor:!0,scrolling:!0},null,8,["value","disabled","placeholder","label"])])]),(0,l.createElementVNode)("div",J,[(0,l.createElementVNode)("div",X,[(0,l.createVNode)(n.A,{value:(0,l.unref)(m).serverLabels,"onUpdate:value":r[11]||(r[11]=e=>(0,l.unref)(m).serverLabels=e),valueCanBeEmpty:!0,disabled:Y.value,loading:Y.value,title:e.t("driver.hetzner.machine.additionalConfig.labels.label"),"three-columns":!1,titleProtip:e.t("driver.hetzner.machine.additionalConfig.labels.description")},null,8,["value","disabled","loading","title","titleProtip"])])])])]))}}),W=(a(4936),a(7433));const Y=(0,W.A)(Q,[["__scopeId","data-v-71deb9ae"]]);var Z=Y},1177:function(e,r,a){var l={"./classic/metadata.json":9621,"./csp/metadata.json":6471,"./federal/metadata.json":1862,"./harvester/metadata.json":1507,"./rgs/metadata.json":8401,"./suse/metadata.json":7259};function t(e){var r=i(e);return a(r)}function i(e){if(!a.o(l,e)){var r=new Error("Cannot find module '"+e+"'");throw r.code="MODULE_NOT_FOUND",r}return l[e]}t.keys=function(){return Object.keys(l)},t.resolve=i,e.exports=t,t.id=1177},4936:function(e,r,a){var l=a(7944);l.__esModule&&(l=l.default),"string"===typeof l&&(l=[[e.id,l,""]]),l.locals&&(e.exports=l.locals);var t=a(4825).A;t("8b21de40",l,!0,{sourceMap:!1,shadowMode:!1})},7944:function(e,r,a){"use strict";a.r(r);var l=a(6758),t=a.n(l),i=a(935),n=a.n(i),s=n()(t());s.push([e.id,".hetzner-config .row.vcenter[data-v-71deb9ae]{align-items:center}.hetzner-config .description[data-v-71deb9ae]{font-size:.9rem;color:var(--input-label)}.hetzner-config .has-error[data-v-71deb9ae] .labeled-select{border-color:var(--error)}.hetzner-config .field-error[data-v-71deb9ae]{display:block;color:var(--error);font-size:.85rem;margin-top:4px}",""]),r["default"]=s}}]);
//# sourceMappingURL=hetzner-node-driver-0.1.0.umd.min.machine-config.js.map